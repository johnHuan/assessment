layui.define(["message","table","jquery","element","yaml","form","tab","menu","frame","theme","convert"],function(e){"use strict";function t(){var e=p(".refresh a");e.removeClass("layui-icon-refresh-1"),e.addClass("layui-anim"),e.addClass("layui-anim-rotate"),e.addClass("layui-anim-loop"),e.addClass("layui-icon-loading"),"true"===d(y)||d(y)===!0?f.refresh(400):m.refresh(400),setTimeout(function(){e.addClass("layui-icon-refresh-1"),e.removeClass("layui-anim"),e.removeClass("layui-anim-rotate"),e.removeClass("layui-anim-loop"),e.removeClass("layui-icon-loading")},600)}function a(){h.collaspe();var e=p(".pear-admin"),t=p(".layui-icon-spread-left"),a=p(".layui-icon-shrink-right");e.is(".pear-mini")?(t.addClass("layui-icon-shrink-right"),t.removeClass("layui-icon-spread-left"),e.removeClass("pear-mini")):(a.addClass("layui-icon-spread-left"),a.removeClass("layui-icon-shrink-right"),e.addClass("pear-mini"))}function l(e){y=e,E.logoRender(e),E.menuRender(e),E.bodyRender(e),E.themeRender(e),E.keepLoad(e),0!=e.header.message&&E.messageRender(e)}function n(e){var t,a=!1;return p.each(y.colors,function(l,n){n.id===e&&(t=n,a=!0)}),(a===!1||y.theme.allowCustom===!1)&&p.each(y.colors,function(e,a){a.id===y.theme.defaultColor&&(t=a)}),t}function o(){var e="";return p.each(y.colors,function(t,a){e+="<span class='select-color-item' color-id='"+a.id+"' style='background-color:"+a.color+";'></span>"}),"<div class='select-color'><div class='select-color-title'>主题配色</div><div class='select-color-content'>"+e+"</div></div>"}function i(){p(window).width()<=768&&a()}function s(e){e=e||1,e=1*e;var t=document.documentElement;switch(e){case 1:t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen();break;case 2:document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}return new Promise(function(e,t){e("返回值")})}function c(){return document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||!1}function r(e){return e.theme.allowCustom&&null!=localStorage.getItem("control")?localStorage.getItem("control"):e.menu.control}function u(e){return e.theme.allowCustom&&null!=localStorage.getItem("auto-head")?localStorage.getItem("auto-head"):e.other.autoHead}function d(e){return e.theme.allowCustom&&null!=localStorage.getItem("muilt-tab")?localStorage.getItem("muilt-tab"):e.tab.enable}var m,h,f,y,g,p=layui.jquery,v=layui.form,b=(layui.element,layui.yaml),k=layui.tab,w=(layui.convert,layui.menu),C=layui.frame,S=layui.theme,I=layui.message,x=function(){},T=p("body"),E=new function(){var e="yml",o="pear.config.yml";this.setConfigPath=function(e){o=e},this.setConfigType=function(t){e=t},this.render=function(e){l(void 0!==e?e:E.readConfig())},this.readConfig=function(){if("yml"===e)return b.load(o);var t;return p.ajax({url:o,type:"get",dataType:"json",async:!1,success:function(e){t=e}}),t},this.messageRender=function(e){var e={elem:".message",url:e.header.message,height:"250px"};g=I.render(e)},this.logoRender=function(e){p(".layui-logo .logo").attr("src",e.logo.image),p(".layui-logo .title").html(e.logo.title)},this.menuRender=function(e){h=w.render({elem:"sideMenu",async:void 0!==e.menu.async?e.menu.async:!0,theme:"dark-theme",height:"100%",method:e.menu.method,control:"true"===r(e)||r(e)===!0?"control":!1,controlWidth:e.menu.controlWidth,defaultMenu:0,accordion:e.menu.accordion,url:e.menu.data,data:e.menu.data,parseData:!1,change:function(){i()},done:function(){h.selectItem(e.menu.select),E.collaspe(e)}})},this.bodyRender=function(e){T.on("click",".refresh",function(){t()}),"true"===d(e)||d(e)===!0?(f=k.render({elem:"content",roll:!0,tool:!0,width:"100%",height:"100%",session:e.tab.session,index:0,tabMax:e.tab.max,closeEvent:function(e){h.selectItem(e)},data:[{id:e.tab.index.id,url:e.tab.index.href,title:e.tab.index.title,close:!1}],success:function(t){e.tab.session&&setTimeout(function(){h.selectItem(t),f.positionTab()},500)}}),f.click(function(t){e.tab.keepState||f.refresh(!1),f.positionTab(),h.selectItem(t)}),h.click(function(e,t){f.addTabOnly({id:t.menuId,title:t.menuTitle,url:t.menuUrl,icon:t.menuIcon,close:!0},300),i()})):(m=C.render({elem:"content",title:"首页",url:e.tab.index.href,width:"100%",height:"100%"}),h.click(function(e,t){m.changePage(t.menuUrl,!0),i()}))},this.keepLoad=function(e){i(),setTimeout(function(){p(".loader-main").fadeOut(200)},e.other.keepLoad)},this.themeRender=function(e){e.theme.allowCustom===!1&&p(".setting").remove();var t=localStorage.getItem("theme-color"),a=n(t);localStorage.setItem("theme-color",a.id),localStorage.setItem("theme-color-color",a.color),localStorage.setItem("theme-color-second",a.second),S.changeTheme(window,u(y));var l=localStorage.getItem("theme-menu");null===l?l=e.theme.defaultMenu:e.theme.allowCustom===!1&&(l=e.theme.defaultMenu);var o=localStorage.getItem("theme-header");null===o?o=e.theme.defaultHeader:e.theme.allowCustom===!1&&(o=e.theme.defaultHeader);var i=localStorage.getItem("theme-banner");null===i?i=e.theme.banner:e.theme.allowCustom===!1&&(i=e.theme.banner);var s=localStorage.getItem("auto-head");null===s?s=e.other.autoHead:e.theme.allowCustom===!1&&(s=e.other.autoHead);var c=localStorage.getItem("muilt-tab");null===c?c=e.tab.enable:e.theme.allowCustom===!1&&(c=e.tab.enable);var r=localStorage.getItem("control");null===r?r=e.menu.control:e.theme.allowCustom===!1&&(r=e.menu.control),localStorage.setItem("muilt-tab",c),localStorage.setItem("theme-banner",i),localStorage.setItem("theme-menu",l),localStorage.setItem("theme-header",o),localStorage.setItem("auto-head",s),localStorage.setItem("control",r),this.menuSkin(l),this.headerSkin(o),this.bannerSkin(i)},this.bannerSkin=function(e){var t=p(".pear-admin");t.removeClass("banner-layout"),(e===!0||"true"===e)&&t.addClass("banner-layout")},this.collaspe=function(e){e.menu.collaspe&&p(window).width()>=768&&a()},this.menuSkin=function(e){var t=p(".pear-admin .layui-side");t.removeClass("light-theme"),t.removeClass("dark-theme"),t.addClass(e)},this.headerSkin=function(e){var t=p(".pear-admin .layui-header");t.removeClass("light-theme"),t.removeClass("dark-theme"),t.addClass(e)},this.logout=function(e){x=e},this.message=function(e){null!=e&&g.click(e)},this.collaspeSide=function(){a()},this.refreshThis=function(){t()},this.refresh=function(e){p("iframe[id='"+e+"']").attr("src",p("iframe[id='"+e+"']").attr("src"))},this.addTab=function(e,t,a){("true"===d(y)||d(y)===!0)&&f.addTabOnly({id:e,title:t,url:a,icon:null,close:!0},400)},this.closeTab=function(e){("true"===d(y)||d(y)===!0)&&k.delTabByElem("content",e,function(e){h.selectItem(e)})},this.closeCurrentTab=function(){("true"===d(y)||d(y)===!0)&&k.delCurrentTabByElem("content",function(e){h.selectItem(e)})},this.closeOtherTab=function(){("true"===d(y)||d(y)===!0)&&k.delOtherTabByElem("content",function(e){h.selectItem(e)})},this.closeAllTab=function(){("true"===d(y)||d(y)===!0)&&k.delAllTabByElem("content",function(e){h.selectItem(e)})},this.changeIframe=function(e,t,a){"true"!==d(y)&&d(y)!==!0&&(h.selectItem(e),m.changePage(a,!0))},this.jump=function(e,t,a){"true"===d(y)||d(y)===!0?E.addTab(e,t,a):E.changeIframe(e,t,a)},this.fullScreen=function(){p(".fullScreen").hasClass("layui-icon-screen-restore")?s(2).then(function(){p(".fullScreen").eq(0).removeClass("layui-icon-screen-restore")}):s(1).then(function(){p(".fullScreen").eq(0).addClass("layui-icon-screen-restore")})}};T.on("click",".logout",function(){x()&&f.clear()}),T.on("click",".collaspe,.pear-cover",function(){a()}),T.on("click",".fullScreen",function(){p(this).hasClass("layui-icon-screen-restore")?s(2).then(function(){p(".fullScreen").eq(0).removeClass("layui-icon-screen-restore")}):s(1).then(function(){p(".fullScreen").eq(0).addClass("layui-icon-screen-restore")})}),T.on("click","[user-menu-id]",function(){"true"===d(y)||d(y)===!0?f.addTabOnly({id:p(this).attr("user-menu-id"),title:p(this).attr("user-menu-title"),url:p(this).attr("user-menu-url"),icon:"",close:!0},300):m.changePage(p(this).attr("user-menu-url"),!0)}),T.on("click",".setting",function(){var e='<li class="layui-this" data-select-bgcolor="dark-theme" ><a href="javascript:;" data-skin="skin-blue" style="" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 12px; background: #28333E;"></span><span style="display:block; width: 80%; float: left; height: 12px; background: white;"></span></div><div><span style="display:block; width: 20%; float: left; height: 40px; background: #28333E;"></span><span style="display:block; width: 80%; float: left; height: 40px; background: #f4f5f7;"></span></div></a></li>';e+='<li  data-select-bgcolor="light-theme" ><a href="javascript:;" data-skin="skin-blue" style="" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 12px; background: white;"></span><span style="display:block; width: 80%; float: left; height: 12px; background: white;"></span></div><div><span style="display:block; width: 20%; float: left; height: 40px; background: white;"></span><span style="display:block; width: 80%; float: left; height: 40px; background: #f4f5f7;"></span></div></a></li>';var t='<div class="pearone-color">\n<div class="color-title">菜单风格</div>\n<div class="color-content">\n<ul>\n'+e+"</ul>\n</div>\n</div>",a='<li class="layui-this" data-select-header="light-theme" ><a href="javascript:;" data-skin="skin-blue" style="" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 12px; background: #28333E;"></span><span style="display:block; width: 80%; float: left; height: 12px; background: white;"></span></div><div><span style="display:block; width: 20%; float: left; height: 40px; background: #28333E;"></span><span style="display:block; width: 80%; float: left; height: 40px; background: #f4f5f7;"></span></div></a></li>';a+='<li  data-select-header="dark-theme" ><a href="javascript:;" data-skin="skin-blue" style="" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 12px; background: #28333E;"></span><span style="display:block; width: 80%; float: left; height: 12px; background: #28333E;"></span></div><div><span style="display:block; width: 20%; float: left; height: 40px; background: #28333E;"></span><span style="display:block; width: 80%; float: left; height: 40px; background: #f4f5f7;"></span></div></a></li>';var l='<div class="pearone-color">\n<div class="color-title">顶部风格</div>\n<div class="color-content">\n<ul>\n'+a+"</ul>\n</div>\n</div>",n='<div class="layui-form-item"><div class="layui-input-inline"><input type="checkbox" name="control" lay-filter="control" lay-skin="switch" lay-text="开|关"></div><span class="set-text">菜单</span></div>';n+='<div class="layui-form-item"><div class="layui-input-inline"><input type="checkbox" name="muilt-tab" lay-filter="muilt-tab" lay-skin="switch" lay-text="开|关"></div><span class="set-text">视图</span></div>',n+='<div class="layui-form-item"><div class="layui-input-inline"><input type="checkbox" name="banner" lay-filter="banner" lay-skin="switch" lay-text="开|关"></div><span class="set-text">通栏</span></div>',n+='<div class="layui-form-item"><div class="layui-input-inline"><input type="checkbox" name="auto-head" lay-filter="auto-head" lay-skin="switch" lay-text="开|关"></div><span class="set-text">通色</span></div>';var i='<br><div class="pearone-color">\n<div class="color-title">更多设置</div>\n<div class="color-content">\n<form class="layui-form">\n'+n+"</form>\n</div>\n</div>";layer.open({type:1,offset:"r",area:["320px","100%"],title:!1,shade:.1,closeBtn:0,shadeClose:!1,anim:-1,skin:"layer-anim-right",move:!1,content:t+l+o()+i,success:function(e,t){v.render();var a=localStorage.getItem("theme-color"),l=localStorage.getItem("theme-menu"),n=localStorage.getItem("theme-header");"null"!==a&&(p(".select-color-item").removeClass("layui-icon").removeClass("layui-icon-ok"),p("*[color-id='"+a+"']").addClass("layui-icon").addClass("layui-icon-ok")),"null"!==l&&(p("*[data-select-bgcolor]").removeClass("layui-this"),p("[data-select-bgcolor='"+l+"']").addClass("layui-this")),"null"!==n&&(p("*[data-select-header]").removeClass("layui-this"),p("[data-select-header='"+n+"']").addClass("layui-this")),p("#layui-layer-shade"+t).click(function(){var e=p("#layui-layer"+t);e.animate({left:e.offset().left+e.width()},200,function(){layer.close(t)})}),v.on("switch(control)",function(e){localStorage.setItem("control",this.checked),window.location.reload()}),v.on("switch(muilt-tab)",function(e){localStorage.setItem("muilt-tab",this.checked),window.location.reload()}),v.on("switch(auto-head)",function(e){localStorage.setItem("auto-head",this.checked),S.changeTheme(window,this.checked)}),v.on("switch(banner)",function(e){localStorage.setItem("theme-banner",this.checked),E.bannerSkin(this.checked)}),"true"===localStorage.getItem("theme-banner")?p('input[name="banner"]').attr("checked","checked"):p('input[name="banner"]').removeAttr("checked"),"true"===localStorage.getItem("control")?p('input[name="control"]').attr("checked","checked"):p('input[name="control"]').removeAttr("checked"),"true"===localStorage.getItem("muilt-tab")?p('input[name="muilt-tab"]').attr("checked","checked"):p('input[name="muilt-tab"]').removeAttr("checked"),"true"===localStorage.getItem("auto-head")?p('input[name="auto-head"]').attr("checked","checked"):p('input[name="auto-head"]').removeAttr("checked"),v.render("checkbox")}})}),T.on("click","[data-select-bgcolor]",function(){var e=p(this).attr("data-select-bgcolor");p("[data-select-bgcolor]").removeClass("layui-this"),p(this).addClass("layui-this"),localStorage.setItem("theme-menu",e),E.menuSkin(e)}),T.on("click","[data-select-header]",function(){var e=p(this).attr("data-select-header");p("[data-select-header]").removeClass("layui-this"),p(this).addClass("layui-this"),localStorage.setItem("theme-header",e),E.headerSkin(e)}),T.on("click",".select-color-item",function(){p(".select-color-item").removeClass("layui-icon").removeClass("layui-icon-ok"),p(this).addClass("layui-icon").addClass("layui-icon-ok");var e=p(".select-color-item.layui-icon-ok").attr("color-id"),t=n(e);localStorage.setItem("theme-color",t.id),localStorage.setItem("theme-color-color",t.color),localStorage.setItem("theme-color-second",t.second),S.changeTheme(window,u(y))}),window.onresize=function(){c()||p(".fullScreen").eq(0).removeClass("layui-icon-screen-restore")},e("admin",E)});